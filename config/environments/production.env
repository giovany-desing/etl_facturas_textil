# ========== ENVIRONMENT CONFIGURATION ==========
# Production - Configuración para ambiente de producción
# NOTA: Secrets vienen de AWS Secrets Manager, no de este archivo

# ========== GENERAL ==========
ENV=production
DEBUG=False
LOG_LEVEL=INFO

# ========== AWS CONFIGURATION ==========
AWS_REGION=us-east-1
AWS_ACCOUNT_ID=123456789012
# Nota: Usar IAM roles, no access keys en producción

# ========== ECS CONFIGURATION ==========
ECS_CLUSTER_NAME=etl-facturas-cluster
ECS_TASK_DEFINITION_FASTAPI=fastapi-service
ECS_TASK_DEFINITION_TRAINING=model-training
ECS_TASK_DEFINITION_MLFLOW=mlflow-server
ECS_SUBNETS=subnet-prod-xxx,subnet-prod-yyy
ECS_SECURITY_GROUPS=sg-prod-xxx
ECS_EXECUTION_ROLE_ARN=arn:aws:iam::123456789012:role/etl-facturas-ecs-task-execution-role
ECS_TASK_ROLE_ARN=arn:aws:iam::123456789012:role/etl-facturas-ecs-task-role

# ========== S3 BUCKETS ==========
S3_BUCKET_FACTURAS=mes-en-curso
S3_BUCKET_MODELOS=textil-modelos
S3_BUCKET_MLFLOW=textil-mlflow-artifacts
S3_BUCKET_DRIFT_DATA=textil-drift-data

# ========== DATABASE ==========
# RDS de producción
MYSQL_HOST=textil.cof2oucystyr.us-east-1.rds.amazonaws.com
MYSQL_PORT=3306
MYSQL_DATABASE=textil
MYSQL_USER=samaca
# MYSQL_PASSWORD se obtiene de Secrets Manager: textil/mysql/credentials

# ========== MLFLOW ==========
MLFLOW_TRACKING_URI=http://mlflow-service.facturas-namespace:5001
MLFLOW_BACKEND_STORE_URI=mysql+pymysql://samaca:MYSQL_PASSWORD@textil.cof2oucystyr.us-east-1.rds.amazonaws.com:3306/mlflow
MLFLOW_ARTIFACT_ROOT=s3://textil-mlflow-artifacts/

# ========== CLOUDWATCH ==========
CLOUDWATCH_LOG_GROUP_FASTAPI=/ecs/fastapi
CLOUDWATCH_LOG_GROUP_TRAINING=/ecs/model-training
CLOUDWATCH_LOG_GROUP_MLFLOW=/ecs/mlflow
CLOUDWATCH_NAMESPACE=ETLFacturasMLOps

# ========== SECRETS MANAGER ==========
# Todos los secretos vienen de Secrets Manager
SECRETS_PREFIX=textil
MYSQL_SECRET_NAME=textil/mysql/credentials
AWS_SECRET_NAME=textil/aws/credentials
GOOGLE_CREDENTIALS_SECRET_NAME=textil/google/credentials
GOOGLE_TOKEN_SECRET_NAME=textil/google/token
SLACK_WEBHOOK_SECRET_NAME=textil/slack/webhook

# ========== MWAA ==========
MWAA_ENVIRONMENT_NAME=etl-facturas-airflow
MWAA_DAG_S3_BUCKET=etl-facturas-airflow-dags

# ========== APPLICATION ==========
API_HOST=0.0.0.0
API_PORT=8000
BASE_DIR=/app
MODELS_DIR=modelos
DATA_DIR=/data

# ========== GOOGLE DRIVE ==========
# Credenciales desde Secrets Manager
GOOGLE_CREDENTIALS_PATH=/app/credentials.json
GOOGLE_TOKEN_PATH=/app/token.json

# ========== TRAINING ==========
TRAIN_BATCH_SIZE=16
TRAIN_EPOCHS=50
TRAIN_VALIDATION_SPLIT=0.2

# ========== DRIFT DETECTION ==========
DRIFT_DATA_ROOT=/app/drift_data
DRIFT_BASELINE_PATH=/app/modelos/baseline_caracteristicas.npy
DRIFT_UMBRAL_P_VALUE=0.05
DRIFT_UMBRAL_STATISTIC=0.3

# ========== NOTIFICATIONS ==========
# Slack webhook desde Secrets Manager
SLACK_WEBHOOK_URL=
EMAIL_FROM=noreply@textil.com
EMAIL_TO=mlops-team@textil.com

# ========== FEATURE FLAGS ==========
ENABLE_DRIFT_DETECTION=True
ENABLE_AUTO_RETRAINING=True
ENABLE_METRICS_EXPORT=True

# ========== ALB ==========
ALB_DNS_NAME=etl-facturas-prod.us-east-1.elb.amazonaws.com
ALB_TARGET_GROUP_ARN=arn:aws:elasticloadbalancing:us-east-1:123456789012:targetgroup/fastapi-prod/xxx

# ========== AUTO-SCALING ==========
FASTAPI_MIN_CAPACITY=2
FASTAPI_MAX_CAPACITY=10
FASTAPI_TARGET_CPU_UTILIZATION=70.0
FASTAPI_TARGET_MEMORY_UTILIZATION=80.0

# ========== SECURITY ==========
# En producción, usar HTTPS
ENABLE_HTTPS=True
SSL_CERTIFICATE_ARN=arn:aws:acm:us-east-1:123456789012:certificate/xxx

